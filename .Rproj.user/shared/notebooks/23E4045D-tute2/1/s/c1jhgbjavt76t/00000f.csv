"0","# Custom function to mask habitats"
"0","mask_habitat <- function(x){"
"0","  pred <- addLayer(etopo2022, x)"
"0","  # Mask continental margin"
"0","  ma <- pred %>% mask(eez) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  ma$Habitat <- cut(-ma$layer, c(0, 200, 4000, 7000), labels=c(""Shelf"", ""Slope"", ""Abyss""))"
"0","  # Mask submarine canyons"
"0","  sc <- pred %>% mask(canyon) %>% mask(eez) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  sc$Habitat <- ""Canyon"""
"0","  # Mask seamounts"
"0","  sm <- pred %>% mask(seamount) %>% mask(eez) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  sm$Habitat <- ""Seamount"""
"0","  # Mask cold water corals"
"0","  cwc <- pred %>% mask(coral) %>% mask(eez) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  cwc$Habitat <- ""CWC"""
"0","  # Mask vent"
"0","  ve <- pred %>% mask(vent) %>% mask(eez) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  ve$Habitat <- ""Vent"""
"0","  # Mask Dongsha Atoll National Park"
"0","  do <- pred %>% mask(dongshaatoll) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  do$Habitat <- ""Dongsha"""
"0","  # Mask Taijiang National Park"
"0","  ta <- pred %>% mask(taijiang) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  ta$Habitat <- ""Taijiang"""
"0","  # Mask White Dolphin Habitat"
"0","  wh <- pred %>% mask(whitedolphin) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  wh$Habitat <- ""Dolphin"""
"0","  # Mask offshore wind farms"
"0","  of <- pred %>% mask(offshorewindplan) %>% as.data.frame(xy = TRUE, na.rm = TRUE)"
"0","  of$Habitat <- ""Windfarm"""
"0","  # Combine and stack data frame"
"0","  rbind(ma, sc, sm, cwc, ve, do, ta, wh, of) %>% gather(-x, -y, -layer, -Habitat, key = ""var"", value = ""value"", factor_key=TRUE)"
"0","}"
